<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas Ortega">

<title>Can You be Approved for a Loan?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="blog_files/libs/clipboard/clipboard.min.js"></script>
<script src="blog_files/libs/quarto-html/quarto.js"></script>
<script src="blog_files/libs/quarto-html/popper.min.js"></script>
<script src="blog_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="blog_files/libs/quarto-html/anchor.min.js"></script>
<link href="blog_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="blog_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="blog_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="blog_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="blog_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.12.1.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lendingclub-loan-applications" id="toc-lendingclub-loan-applications" class="nav-link active" data-scroll-target="#lendingclub-loan-applications">LendingClub Loan Applications</a>
  <ul class="collapse">
  <li><a href="#goals-and-introduction-to-features" id="toc-goals-and-introduction-to-features" class="nav-link" data-scroll-target="#goals-and-introduction-to-features">Goals and Introduction to Features</a></li>
  <li><a href="#preprocessing-the-data" id="toc-preprocessing-the-data" class="nav-link" data-scroll-target="#preprocessing-the-data">Preprocessing the Data</a>
  <ul class="collapse">
  <li><a href="#zip-codes-table" id="toc-zip-codes-table" class="nav-link" data-scroll-target="#zip-codes-table">ZIP Codes Table</a></li>
  <li><a href="#accepted-loans-table" id="toc-accepted-loans-table" class="nav-link" data-scroll-target="#accepted-loans-table">Accepted Loans Table</a></li>
  <li><a href="#accepted-and-rejected-loans-table" id="toc-accepted-and-rejected-loans-table" class="nav-link" data-scroll-target="#accepted-and-rejected-loans-table">Accepted and Rejected Loans Table</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#is-employment-length-significant" id="toc-is-employment-length-significant" class="nav-link" data-scroll-target="#is-employment-length-significant">Is employment length significant?</a></li>
  <li><a href="#are-specific-loans-given-during-certain-months" id="toc-are-specific-loans-given-during-certain-months" class="nav-link" data-scroll-target="#are-specific-loans-given-during-certain-months">Are specific loans given during certain months?</a>
  <ul class="collapse">
  <li><a href="#natural-language-processing" id="toc-natural-language-processing" class="nav-link" data-scroll-target="#natural-language-processing">Natural Language Processing</a></li>
  <li><a href="#graphic" id="toc-graphic" class="nav-link" data-scroll-target="#graphic">Graphic</a></li>
  </ul></li>
  <li><a href="#what-is-the-rate-of-acceptance" id="toc-what-is-the-rate-of-acceptance" class="nav-link" data-scroll-target="#what-is-the-rate-of-acceptance">What is the rate of acceptance?</a></li>
  <li><a href="#how-does-debt-to-income-and-fico-score-change-based-on-hardship-flag-home-ownership-and-application-type" id="toc-how-does-debt-to-income-and-fico-score-change-based-on-hardship-flag-home-ownership-and-application-type" class="nav-link" data-scroll-target="#how-does-debt-to-income-and-fico-score-change-based-on-hardship-flag-home-ownership-and-application-type">How does debt-to-income and FICO Score change based on hardship flag, home ownership, and application type?</a></li>
  <li><a href="#does-fico-score-change-the-interest-rate" id="toc-does-fico-score-change-the-interest-rate" class="nav-link" data-scroll-target="#does-fico-score-change-the-interest-rate">Does FICO Score change the interest rate?</a></li>
  <li><a href="#is-there-a-bound-using-dti" id="toc-is-there-a-bound-using-dti" class="nav-link" data-scroll-target="#is-there-a-bound-using-dti">Is there a bound using DTI?</a></li>
  <li><a href="#can-the-data-effectively-predict-whether-a-candidate-will-be-accepted-or-rejected" id="toc-can-the-data-effectively-predict-whether-a-candidate-will-be-accepted-or-rejected" class="nav-link" data-scroll-target="#can-the-data-effectively-predict-whether-a-candidate-will-be-accepted-or-rejected">Can the data effectively predict whether a candidate will be accepted or rejected?</a>
  <ul class="collapse">
  <li><a href="#fitting-models" id="toc-fitting-models" class="nav-link" data-scroll-target="#fitting-models">Fitting Models</a></li>
  <li><a href="#model-equations" id="toc-model-equations" class="nav-link" data-scroll-target="#model-equations">Model Equations</a></li>
  <li><a href="#confusion-matrix-and-results" id="toc-confusion-matrix-and-results" class="nav-link" data-scroll-target="#confusion-matrix-and-results">Confusion Matrix and Results</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Can You be Approved for a Loan?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Spring 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas Ortega </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="lendingclub-loan-applications" class="level1">
<h1>LendingClub Loan Applications</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="loanphoto.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Photo downloaded from Unsplash: Credits - Tierra Mallorca</figcaption><p></p>
</figure>
</div>
<p>LendingClub is one of many financial service companies located in the United States. Their personal loan service has received millions of applications since 2007. Out of those millions, a fraction of those applications are accepted. As a college student transitioning from a dependent to an independent in the United States, there is little doubt in my mind that I will be applying for a loan in the near future. Since I will be applying for loans, I want to understand how to maximize my odds of approval. Fortunately, some financial service companies have released information about the people that have applied for loans. Through a Kaggle dataset <span class="citation" data-cites="geor19">George (<a href="#ref-geor19" role="doc-biblioref">2019</a>)</span>, I was able to track loan applicants that applied for loans through LendingClub.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can find the link to my full code and documentation here: <a href="https://github.com/tortega-24/capstone-loan-applicants/tree/main">GitHub Repository</a></p>
</div>
</div>
<p>The data spans 11 years, from 2007 to 2018, and contains two tables: a rejected and an accepted loan applicant table. The accepted applicant table contains approximately 2 million rows and lists over 150 features. The rejected applicant table extends out to about 27 million rows, and has exactly 9 features. To understand all of the different features, a separate Kaggle resource was used that identifies the columns that appear in the dataset <span class="citation" data-cites="chan18">Chan (<a href="#ref-chan18" role="doc-biblioref">2018</a>)</span>. Many variables are based on financial concepts or related to the applicant following their acceptance.</p>
<section id="goals-and-introduction-to-features" class="level2">
<h2 class="anchored" data-anchor-id="goals-and-introduction-to-features">Goals and Introduction to Features</h2>
<p>My goal for the analysis was to focus on features that were easily understandable and were characteristics of the customer. I wanted to describe loan applicants and build a model using some of the features. I defined seven different questions that tackled unique aspects of the data. The table of contents describes each question I address. Here is a list of some of the features I plan to use:</p>
<p>ZIP Code, FICO Score, Debt-to-Income Ratio, Employment Length, Reason for Loan, Homeowner Status, Hardship Status, and Interest Rate.</p>
<p>:::{.callout-note} The list of features above is not complete. :::</p>
<p><strong>Imports for Project</strong></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fiona</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> VotingClassifier</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier <span class="im">as</span> knn</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math <span class="im">as</span> m</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#from plotnine import ggplot, geom_point, aes, stat_smooth, facet_wrap</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preprocessing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="preprocessing-the-data">Preprocessing the Data</h2>
<p>Before answering the questions, the data needed to be shaped and organized. A mix of cleaning techniques were used to break the raw csv files into distinct tables: a ZIP Code table, a model table, and an accepted applicant table. The first step is to import the files as dataframes.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not every piece of processing code will be displayed. Visit the repository for the complete code.</p>
</div>
</div>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading Data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>accepted <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_2007_to_2018Q4.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>rejected <span class="op">=</span> pd.read_csv(<span class="st">"../rejected_2007_to_2018Q4.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding Result Column</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>accepted[<span class="st">'Applicant_Result'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>rejected[<span class="st">'Applicant_Result'</span>] <span class="op">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two files being imported from the Kaggle dataset are large in size and could not be uploaded to the Github repository.</p>
</div>
</div>
<section id="zip-codes-table" class="level3">
<h3 class="anchored" data-anchor-id="zip-codes-table">ZIP Codes Table</h3>
<p>Next, I start processing a csv for ZIP Codes. Both raw tables contain applicants’ first three digits of their ZIP Code. A new dataset will combine both ZIP Code columns and an applicant result column. A few missing values in the data will be dropped.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rejected[<span class="st">'Zip Code'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(rejected)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>accepted[<span class="st">'zip_code'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(accepted)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>zip_df <span class="op">=</span> rejected[[<span class="st">'Zip Code'</span>, <span class="st">'Applicant_Result'</span>]].rename(columns<span class="op">=</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                                                           {<span class="st">"Zip Code"</span>: <span class="st">"zip_code"</span>, <span class="st">"Applicant_Result"</span>: <span class="st">"applicant_result"</span>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>zip_df <span class="op">=</span> pd.concat([zip_df, accepted[[<span class="st">'zip_code'</span>, <span class="st">'Applicant_Result'</span>]].rename(columns<span class="op">=</span>{<span class="st">"Applicant_Result"</span>: <span class="st">"applicant_result"</span>})]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                   , axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>zip_df.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>zip_df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>zip_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="accepted-loans-table" class="level3">
<h3 class="anchored" data-anchor-id="accepted-loans-table">Accepted Loans Table</h3>
<p>The next table I will be making lists accepted loan applications. To clean the columns I defined how many missing values were in each feature. Then, I decided to remove columns that contained at least 30% missing values.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>col_to_be_dropped <span class="op">=</span> []</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> accepted.columns:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (accepted[column].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(accepted)) <span class="op">&gt;</span> <span class="fl">0.3</span>:</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        col_to_be_dropped.append(column)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>trimmed_accepted <span class="op">=</span> accepted.drop(col_to_be_dropped, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>trimmed_accepted.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After looking over the columns, I selected variables that would be most related to the questions I planned to answer. Then, after selecting my features, I took the percentage of values I would have left if I decided to drop their NA rows. With a remaining 91%, I decided it would be acceptable to drop the missing values instead of attempting to replace them. Lastly, I changed the type of the FICO Score columns and the policy code to integers. The final table consisted of 17 features.</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>columns_needed <span class="op">=</span> [<span class="st">'loan_amnt'</span>, <span class="st">'title'</span>, <span class="st">'last_fico_range_low'</span>, <span class="st">'last_fico_range_high'</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'dti'</span>, <span class="st">'zip_code'</span>, <span class="st">'addr_state'</span>, <span class="st">'emp_length'</span>, <span class="st">'emp_title'</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'funded_amnt'</span>, <span class="st">'hardship_flag'</span>, <span class="st">'home_ownership'</span>, <span class="st">'loan_status'</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'application_type'</span>, <span class="st">'issue_d'</span>, <span class="st">'policy_code'</span>, <span class="st">'Applicant_Result'</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># accepted_project_cut = accepted_project.dropna(axis=0)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># len(accepted_project_cut)/len(accepted_project) = 0.9168417229876927</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>accepted_project <span class="op">=</span> trimmed_accepted[columns_needed]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>accepted_project.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'last_fico_range_low'</span>] <span class="op">=</span> accepted_project[<span class="st">'last_fico_range_low'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'last_fico_range_high'</span>] <span class="op">=</span> accepted_project[<span class="st">'last_fico_range_high'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'policy_code'</span>] <span class="op">=</span> accepted_project[<span class="st">'policy_code'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>accepted_project.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="accepted-and-rejected-loans-table" class="level3">
<h3 class="anchored" data-anchor-id="accepted-and-rejected-loans-table">Accepted and Rejected Loans Table</h3>
<p>Lastly, I wanted to build a table that combined both accepted and rejected loan applications. To start, all columns from the rejected table were attempted to be matched to a column from the accepted table. The ‘Risk_Score’ column in the rejected applicant table was not considered because it contained too many missing values (~18 million). The remaining columns had a low percentage of missing values and those observations were dropped. Another edit that was made changed the debt-to-income ratio column to be a float type. To do this, I removed the percent sign and converted the data type.</p>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>trimmed_rejected <span class="op">=</span> rejected.drop([<span class="st">'Risk_Score'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>] <span class="op">=</span> trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>].<span class="bu">str</span>.replace(<span class="st">'%'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>] <span class="op">=</span> trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>].astype(<span class="st">'float64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, I used the sample method to take 100,000 rows from each table and concatenated them to form a new table. Finally, all three tables were written as csv files.</p>
</section>
</section>
</section>
<section id="is-employment-length-significant" class="level1">
<h1>Is employment length significant?</h1>
<p>To analyze the employment length, a grouped bar chart comparing loan applicants was made. This was taken using the model data that randomly sampled both loan applications.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../model_only_data.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>question_one <span class="op">=</span> df[[<span class="st">'applicant_result'</span>, <span class="st">'emp_length'</span>]]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(pd.unique(question_one[<span class="st">'emp_length'</span>])))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> question_one[<span class="st">'emp_length'</span>][question_one[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">1</span>].value_counts().sort_index().values</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> question_one[<span class="st">'emp_length'</span>][question_one[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">0</span>].value_counts().sort_index().values</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> y1[<span class="dv">0</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">0</span>] <span class="op">=</span> y1[<span class="dv">10</span>]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>temp2 <span class="op">=</span> y1[<span class="dv">1</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">1</span>] <span class="op">=</span> temp</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">10</span>] <span class="op">=</span> temp2</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> y2[<span class="dv">0</span>]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">0</span>] <span class="op">=</span> y2[<span class="dv">10</span>]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>temp2 <span class="op">=</span> y2[<span class="dv">1</span>]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">1</span>] <span class="op">=</span> temp</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">10</span>] <span class="op">=</span> temp2</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>plt.bar(x<span class="op">-</span><span class="fl">0.2</span>, y1, width, color<span class="op">=</span><span class="st">'cyan'</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>plt.bar(x, y2, width, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>plt.xticks(x, [<span class="st">'&lt; 1 year'</span>, <span class="st">'1 year'</span>, <span class="st">'2 years'</span>, <span class="st">'3 years'</span>, <span class="st">'4 years'</span>, <span class="st">'5 years'</span>, <span class="st">'6 years'</span>, <span class="st">'7 years'</span>, <span class="st">'8 years'</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'9 years'</span>, <span class="st">'10+ years'</span>], rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Self-Reported Employment Length"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Counts"</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Accepted Vs. Rejected Based on Employment Length"</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">"Accepted"</span>, <span class="st">"Rejected"</span>])</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-employment" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="blog_files/figure-html/fig-employment-output-1.png" width="610" height="506" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Employment Length</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-employment">Figure&nbsp;1</a> many of the rejected candidates reported that they have been at their job for less than a year. In contrast, a large portion of accepted applications listed an employment length of 10 plus years. Based on the visual, it appears that applicants with a year or more experience are favored.</p>
</section>
<section id="are-specific-loans-given-during-certain-months" class="level1">
<h1>Are specific loans given during certain months?</h1>
<p>Utilizing natural language processing and some manual identification, I was able to group many of the different reasons applicants applied for loans. This was reflected in a rose chart that is labeled by month and takes all accepted applicant data from 2007-2018.</p>
<section id="natural-language-processing" class="level2">
<h2 class="anchored" data-anchor-id="natural-language-processing">Natural Language Processing</h2>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> <span class="st">""</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> i <span class="op">&lt;</span> <span class="bu">len</span>(df[<span class="st">'reason_for_loan'</span>]):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    corpus <span class="op">+=</span> <span class="st">" "</span> <span class="op">+</span> df[<span class="st">'reason_for_loan'</span>][i]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">"english"</span>)) <span class="co"># creating a list of stop words in the english language</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>filtered_list <span class="op">=</span> []</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> words: <span class="co"># For every word</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> word.casefold() <span class="kw">not</span> <span class="kw">in</span> stop_words: <span class="co"># Is the lowercase word in the stop words list?</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        filtered_list.append(word)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>lemma_corpus <span class="op">=</span> []</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>no_match <span class="op">=</span> []</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word, tag <span class="kw">in</span> nltk.pos_tag(filtered_list):</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    wntag <span class="op">=</span> tag[<span class="dv">0</span>].lower()</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    wntag <span class="op">=</span> wntag <span class="cf">if</span> wntag <span class="kw">in</span> [<span class="st">'a'</span>, <span class="st">'r'</span>, <span class="st">'n'</span>, <span class="st">'v'</span>] <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> wntag:</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        lemma <span class="op">=</span> word <span class="co"># if it is not one of the above word types</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        no_match.append(lemma)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        lemma <span class="op">=</span> lemmatizer.lemmatize(word, wntag) <span class="co"># using the tag to properly reduce the word</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        lemma_corpus.append(lemma)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>no_match_series <span class="op">=</span> pd.Series(no_match)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series <span class="op">=</span> pd.Series(lemma_corpus)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the top words</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series.value_counts().index[<span class="dv">0</span>:<span class="dv">100</span>]</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series.value_counts().index[<span class="dv">100</span>:<span class="dv">150</span>]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>no_match_series.value_counts().index[<span class="dv">0</span>:<span class="dv">50</span>]</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Categories that the information was sorted into</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>home <span class="op">=</span> [<span class="st">'home'</span>, <span class="st">'house'</span>, <span class="st">'kitchen'</span>, <span class="st">'improvement'</span>, <span class="st">'pool'</span>, <span class="st">'remodel'</span>]</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>car <span class="op">=</span> [<span class="st">'car'</span>, <span class="st">'auto'</span>, <span class="st">'motorcycle'</span>, <span class="st">'vehicle'</span>, <span class="st">'truck'</span>]</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>business <span class="op">=</span> [<span class="st">'business'</span>]</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>medical <span class="op">=</span> [<span class="st">'medical'</span>, <span class="st">'remove'</span>]</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>debt_credit_issues <span class="op">=</span> [<span class="st">'consolidation'</span>, <span class="st">'credit'</span>, <span class="st">'debt'</span>, <span class="st">'refinancing'</span>, <span class="st">'card'</span>, <span class="st">'cc'</span>, <span class="st">'consolidate'</span>, <span class="st">'payoff'</span>, </span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'interest'</span>, <span class="st">'rate'</span>] </span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>moving <span class="op">=</span> [<span class="st">'move'</span>, <span class="st">'moving'</span>]</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>major_purchase <span class="op">=</span> [<span class="st">'purchase'</span>, <span class="st">'major'</span>]</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>vacation <span class="op">=</span> [<span class="st">'vacation'</span>]</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>wedding <span class="op">=</span> [<span class="st">'wedding'</span>, <span class="st">'ring'</span>]</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>student <span class="op">=</span> [<span class="st">'student'</span>, <span class="st">'college'</span>, <span class="st">'education'</span>, <span class="st">'school'</span>]</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Code used to check the context of specific words</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="co">#l = []</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#for thing in df['reason_for_loan']:</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co">#    if thing.find("refinancing") != -1:</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#        l.append(thing)</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co">#print(pd.unique(l))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="graphic" class="level2">
<h2 class="anchored" data-anchor-id="graphic">Graphic</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>group_dates <span class="op">=</span> pd.read_csv(<span class="st">"../group_dates.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar_polar(group_dates, r<span class="op">=</span><span class="st">"count"</span>,theta<span class="op">=</span><span class="st">'issue_month'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span><span class="st">"reduced_reason"</span>, labels<span class="op">=</span>{<span class="st">"reduced_reason"</span>: <span class="st">"Loan Types"</span>})</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.80</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">1.1</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"LightGray"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"Black"</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    borderwidth<span class="op">=</span><span class="dv">1</span>),font<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">15</span>))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_nticks<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>fig.update_polars(angularaxis_tickfont_size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_tickfont_size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_angle<span class="op">=</span><span class="dv">70</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_tickangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">'toImageButtonOptions'</span>: {</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'png'</span>, <span class="co"># one of png, svg, jpeg, webp</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'filename'</span>: <span class="st">'custom_image'</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'height'</span>: <span class="dv">1680</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'width'</span>: <span class="dv">2380</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>fig.show(config<span class="op">=</span>config)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-type" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>                            <div id="96e4f09a-a7f4-492a-9394-cdce01f90e95" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("96e4f09a-a7f4-492a-9394-cdce01f90e95")) {                    Plotly.newPlot(                        "96e4f09a-a7f4-492a-9394-cdce01f90e95",                        [{"hovertemplate":"Loan Types=Business<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Business","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Business","r":[9,2,6,30,73,54,143,263,296,384,449,13,8,12,26,68,61,131,228,334,327,422,14,19,11,36,68,75,158,215,608,400,423,18,17,11,30,71,63,195,275,354,301,417,5,12,9,44,82,83,159,180,332,381,446,3,15,9,34,71,75,160,224,322,321,330,1,4,9,13,42,91,79,254,283,324,354,288,1,6,12,10,57,97,89,152,270,323,441,283,2,6,14,27,59,75,116,92,226,315,424,241,6,3,10,14,60,80,85,323,351,351,424,214,8,14,9,20,54,77,99,216,275,340,513,196,6,10,10,21,56,59,120,110,452,487,515,211],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Car<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Car","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Car","r":[46,49,59,203,449,1272,3624,7753,7421,6705,8134,75,46,81,181,466,1468,3837,5494,8587,5948,7146,76,57,96,196,456,1468,4026,5863,12559,7902,8431,55,61,104,213,496,1544,4491,7811,6993,6065,9857,20,63,120,205,488,1768,4355,7223,5307,7685,11305,5,31,67,111,236,595,1815,4036,6380,6195,7439,10732,17,29,94,160,257,737,1900,6458,11031,6220,7796,11505,19,17,93,169,258,875,2032,3925,8866,6588,8548,11593,10,20,100,122,268,1009,2220,2436,6927,5059,7258,9804,18,21,70,155,300,990,2467,8526,12040,6281,7482,11166,15,39,56,166,344,1025,2861,5463,9130,6926,9012,10147,21,41,65,177,442,997,2924,2339,10743,7029,8101,9227],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Debt/Credit Issues<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Debt/Credit Issues","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Debt/Credit Issues","r":[62,77,159,449,1029,3297,8079,21212,16059,17231,17187,81,80,181,410,1022,3635,8077,13828,19529,14531,15329,109,72,203,405,1081,3852,9242,14574,30654,19279,17796,67,50,233,448,1200,4323,10720,20497,17388,15139,19377,30,77,236,529,1262,4612,10896,18696,13955,19542,20794,3,23,80,277,582,1584,4936,9799,16603,16221,20253,18629,7,26,96,310,597,1975,5454,17507,25774,18167,20824,21389,9,14,128,322,689,2292,5732,11207,19533,18589,22812,22164,14,10,129,318,762,2698,6043,5950,15796,14448,20857,18926,15,25,137,384,772,2830,6550,23142,26480,17771,19103,21523,22,42,155,333,833,2897,6735,14818,20172,18861,20353,19375,34,70,171,368,926,2840,6880,5659,23520,19147,17913,18487],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Home<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Home","marker":{"color":"#ab63fa","pattern":{"shape":""}},"name":"Home","r":[12,12,31,54,117,314,658,1579,1713,2082,2601,11,9,29,64,133,322,732,1118,2206,1936,2423,14,19,43,107,201,481,924,1469,4031,2806,3244,8,19,55,126,217,598,1180,2276,2556,2609,3724,5,25,59,162,247,644,1290,1912,2064,3251,3845,1,5,35,76,172,260,700,1058,1715,2711,3087,3187,3,7,32,52,162,267,694,1665,2817,2485,3090,2690,4,4,19,69,124,288,694,1034,2082,2433,3280,2823,2,2,34,79,137,303,690,617,1832,2021,3142,2145,2,4,46,73,141,274,684,1850,3041,2469,3112,2532,6,14,39,78,125,284,615,1239,2398,2328,3305,2147,9,11,34,70,85,275,636,575,2581,2429,2717,2085],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Major Purchase<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Major Purchase","marker":{"color":"#FFA15A","pattern":{"shape":""}},"name":"Major Purchase","r":[12,6,6,22,29,42,171,478,533,608,961,3,3,10,14,25,57,187,365,723,578,943,6,9,7,19,41,77,242,400,1306,833,1097,2,12,10,21,42,92,315,585,804,684,1172,2,9,6,41,38,75,340,475,629,864,1246,2,12,14,30,38,78,282,445,873,911,1067,1,7,17,29,56,115,433,730,754,926,741,2,10,9,32,60,114,323,632,810,1066,757,1,11,12,40,56,93,196,503,674,925,591,4,6,12,30,56,93,543,804,739,867,658,6,10,23,20,52,97,352,694,723,994,638,3,8,1,18,19,43,119,224,867,839,1126,598],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Medical<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Medical","marker":{"color":"#19d3f3","pattern":{"shape":""}},"name":"Medical","r":[5,3,1,22,26,48,160,250,299,382,528,3,2,2,17,25,36,150,168,381,356,449,3,3,3,14,24,43,138,196,564,478,560,2,3,10,13,38,63,164,270,354,399,607,2,5,12,21,44,57,215,256,318,552,625,7,8,22,32,77,147,202,427,554,510,2,6,9,26,63,61,265,399,376,538,455,3,5,11,23,46,110,160,291,338,618,416,3,17,38,67,82,121,251,352,570,328,8,10,32,61,91,322,464,434,573,410,2,1,2,15,33,67,106,212,376,447,585,410,4,1,4,27,25,43,134,115,471,449,566,378],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Moving<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Moving","marker":{"color":"#FF6692","pattern":{"shape":""}},"name":"Moving","r":[5,8,11,9,31,57,159,165,219,223,4,2,5,8,13,26,55,110,193,183,207,1,5,5,13,19,39,63,124,315,250,246,3,7,10,17,30,49,84,200,251,226,258,1,2,14,18,21,55,98,184,187,327,321,1,1,3,15,19,36,59,87,185,292,329,267,1,5,2,27,25,26,80,168,298,293,354,232,2,3,9,16,32,41,78,129,191,294,360,271,10,21,20,44,83,84,159,229,304,203,1,7,14,21,46,65,236,228,251,264,207,5,8,11,17,33,67,115,197,225,288,164,3,3,3,5,19,38,69,70,236,246,266,185],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Other<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Other","marker":{"color":"#B6E880","pattern":{"shape":""}},"name":"Other","r":[118,91,283,452,598,1329,1365,1434,1416,1839,3057,91,126,271,414,556,1447,498,889,1727,1625,2566,135,111,342,491,740,1651,621,1071,3224,2226,3148,81,128,375,529,866,1958,800,1559,2312,1946,3709,39,120,420,516,919,2136,760,1192,1676,2235,3605,6,38,130,470,533,860,2288,719,1139,2116,2459,3051,18,47,111,507,529,1040,2527,1169,1828,2281,2600,2148,18,35,127,471,522,1260,2786,847,1483,2398,2952,2321,17,12,162,475,533,1367,2727,526,1229,1904,2735,1677,47,49,245,430,534,1430,3000,1615,2072,2193,3057,2000,36,61,271,466,558,1417,3033,1113,1777,2220,3428,1868,72,89,245,487,521,1310,2876,572,2301,2474,3395,1929],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Student<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Student","marker":{"color":"#FF97FF","pattern":{"shape":""}},"name":"Student","r":[12,9,10,10,9,21,13,1,8,9,23,7,14,19,17,10,20,9,8,21,2,11,23,14,13,22,4,21,26,6,8,23,1,2,27,15,8,13,26,5,8,20,11,10,16,35,9,9,16,9,11,14,46,3,1,17,13,6,19,35,8,6,19,7,8,20,29,9,13,21,9,8,29,38,5,6,21,4,2,14,46],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Vacation<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Vacation","marker":{"color":"#FECB52","pattern":{"shape":""}},"name":"Vacation","r":[1,1,1,8,14,15,54,138,133,200,201,2,1,2,4,11,14,57,91,168,198,190,2,5,11,11,20,61,124,327,313,277,1,2,6,10,31,93,166,234,243,304,1,9,17,25,53,85,175,221,384,352,1,3,1,11,18,32,55,113,162,241,452,339,1,3,15,35,59,174,314,323,404,296,1,1,2,7,16,27,57,100,178,285,427,261,3,6,11,31,57,49,126,189,270,190,1,2,8,14,38,46,147,203,218,240,225,2,3,10,26,53,111,166,218,268,215,2,16,12,18,55,58,224,317,286,249],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"},{"hovertemplate":"Loan Types=Wedding<br>count=%{r}<br>issue_month=%{theta}<extra></extra>","legendgroup":"Wedding","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Wedding","r":[8,11,16,38,37,54,35,7,9,12,42,27,63,2,12,9,28,49,50,84,5,14,36,49,61,108,2,4,10,26,32,77,110,1,8,16,36,60,81,89,1,6,18,35,53,92,116,2,3,15,35,53,100,138,3,12,33,61,102,114,2,4,13,38,48,74,76,4,5,19,35,56,86,58,5,6,15,46,26,61,64],"showlegend":true,"subplot":"polar","theta":["Jan","Jan","Jan","Jan","Jan","Jan","Jan","Feb","Feb","Feb","Feb","Feb","Feb","Feb","Mar","Mar","Mar","Mar","Mar","Mar","Apr","Apr","Apr","Apr","Apr","Apr","Apr","May","May","May","May","May","May","Jun","Jun","Jun","Jun","Jun","Jun","Jun","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec"],"type":"barpolar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"polar":{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"angularaxis":{"direction":"clockwise","rotation":90,"tickfont":{"size":15}},"radialaxis":{"nticks":11,"tickfont":{"size":15},"angle":70,"tickangle":90}},"legend":{"title":{"text":"Loan Types"},"tracegroupgap":0,"yanchor":"top","y":0.8,"xanchor":"left","x":1.1,"bgcolor":"LightGray","bordercolor":"Black","borderwidth":1},"margin":{"t":60},"barmode":"relative","font":{"size":15}},                        {"toImageButtonOptions": {"format": "png", "filename": "custom_image", "height": 1680, "width": 2380}, "responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('96e4f09a-a7f4-492a-9394-cdce01f90e95');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Loan Type</figcaption><p></p>
</figure>
</div>
</div>
<p>Looking at the rose chart <a href="#fig-type">Figure&nbsp;2</a>, we can observe a couple things. Firstly, three of the 12 months have a noticeable drop in overall accepted applicant counts. Why is there a drop? It is not entirely clear. Nothing jumps out as an explanation while doing some Googling. It might be a situation unique to LendingClub.</p>
<p>I can shed some light on whether the pattern is consistent for each year or different. By creating a gif, we can observe the yearly changes in counts by month.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="loantypes.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Different LendingClub Loan Applications by Month and Year</figcaption><p></p>
</figure>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the gif ranges from 2008 to 2018. It does not cover 2007 because LendingClub had small counts for that year and did not accept candidates in every month.</p>
</div>
</div>
</section>
</section>
<section id="what-is-the-rate-of-acceptance" class="level1">
<h1>What is the rate of acceptance?</h1>
<p>LendingClub has had over <a href="https://ir.lendingclub.com/news/news-details/2022/LendingClub-Surpasses-4-Million-Members/default.aspx">4 million members</a> with people signing up across the United States. So, what does the acceptance rate look like across the U.S.? Using census data, I made a choropleth graphic visualizing the acceptance rate across 48 of the states–sorry Alaska and Hawaii.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alaskan and Hawaiian citizens can apply for loans via LendingClub; but, they are not included because it stretches the choropleth.</p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_map_2015 <span class="op">=</span> gpd.read_file(<span class="st">'../2015_map_data.shp'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">50</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>df_map_2015.plot(column <span class="op">=</span> df_map_2015[<span class="st">'accepted_rejected_ratio'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>, legend<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            legend_kwds<span class="op">=</span>{<span class="st">'label'</span>: <span class="st">"Ratio of Accepted Applicants"</span>, <span class="st">'orientation'</span>: <span class="st">"horizontal"</span>, <span class="st">"pad"</span>: <span class="fl">0.01</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"shrink"</span>: <span class="fl">.7</span>}, ax<span class="op">=</span>ax, alpha<span class="op">=</span><span class="fl">.9</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="op">-</span><span class="dv">126</span>, <span class="op">-</span><span class="dv">65</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">24</span>, <span class="dv">50</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.title</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ratio_accepted.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Ratio of Accepted Applicants by ZIP Code</figcaption><p></p>
</figure>
</div>
<p>The interesting thing that stands out is the large, scary space outlining the state of Iowa. As of the dates collected from the Kaggle dataset, Iowa did not allow their citizens to apply for loans with LendingClub. This is the most likely explanation for the abysmal acceptance rate. Besides Iowa’s low rate, no other group of ZIP Codes stand out.</p>
</section>
<section id="how-does-debt-to-income-and-fico-score-change-based-on-hardship-flag-home-ownership-and-application-type" class="level1">
<h1>How does debt-to-income and FICO Score change based on hardship flag, home ownership, and application type?</h1>
<p>Loan applicants that are approved for loans must have differences between each other–right? To take a further look, I describe applicants by their homeowner status, whether they filed jointly or not, and if they have had to reduce their payment plans in the past (hardhip flag). Those features will be ordered based on median FICO scores and debt-to-income (DTI) ratios.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'home_ownership'</span>].isin([<span class="st">'OTHER'</span>, <span class="st">'ANY'</span>, <span class="st">'NONE'</span>])]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>grouped_values <span class="op">=</span> df_new.groupby([<span class="st">'home_ownership'</span>, <span class="st">'application_type'</span>, <span class="st">'hardship_flag'</span>])[<span class="st">'fico_range_low'</span>].median()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>grouped_values <span class="op">=</span> pd.DataFrame(grouped_values)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>grouped_values.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> grouped_values.sort_values(by<span class="op">=</span><span class="st">'fico_range_low'</span>,ascending<span class="op">=</span><span class="va">False</span>).head()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>sorted_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>,drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>sorted_df.rename(columns<span class="op">=</span>{<span class="st">"home_ownership"</span>: <span class="st">"Ownership"</span>, <span class="st">"application_type"</span>: <span class="st">"Application Type"</span>, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"hardship_flag"</span>: <span class="st">"Hardship Flag"</span>, <span class="st">"fico_range_low"</span>: <span class="st">"FICO Score"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>sorted_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-fico" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ownership</th>
      <th>Application Type</th>
      <th>Hardship Flag</th>
      <th>FICO Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>OWN</td>
      <td>Joint App</td>
      <td>Y</td>
      <td>720.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>OWN</td>
      <td>Joint App</td>
      <td>N</td>
      <td>710.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MORTGAGE</td>
      <td>Joint App</td>
      <td>N</td>
      <td>705.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MORTGAGE</td>
      <td>Joint App</td>
      <td>Y</td>
      <td>700.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RENT</td>
      <td>Joint App</td>
      <td>N</td>
      <td>700.0</td>
    </tr>
  </tbody>
</table>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Loan FICO</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'home_ownership'</span>].isin([<span class="st">'OTHER'</span>, <span class="st">'ANY'</span>, <span class="st">'NONE'</span>])]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>grouped_values_dti <span class="op">=</span> df_new.groupby([<span class="st">'home_ownership'</span>, <span class="st">'application_type'</span>, <span class="st">'hardship_flag'</span>])[<span class="st">'dti'</span>].median()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>grouped_values_dti <span class="op">=</span> pd.DataFrame(grouped_values_dti)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>grouped_values_dti.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> grouped_values_dti.sort_values(by<span class="op">=</span><span class="st">'dti'</span>, ascending<span class="op">=</span><span class="va">True</span>).head()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>sorted_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>,drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>sorted_df.rename(columns<span class="op">=</span>{<span class="st">"home_ownership"</span>: <span class="st">"Ownership"</span>, <span class="st">"application_type"</span>: <span class="st">"Application Type"</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"hardship_flag"</span>: <span class="st">"Hardship Flag"</span>, <span class="st">"dti"</span>: <span class="st">"Debt-to-Income Ratio"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>sorted_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-dti" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Ownership</th>
      <th>Application Type</th>
      <th>Hardship Flag</th>
      <th>Debt-to-Income Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>OWN</td>
      <td>Joint App</td>
      <td>Y</td>
      <td>11.90</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RENT</td>
      <td>Individual</td>
      <td>N</td>
      <td>17.30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RENT</td>
      <td>Individual</td>
      <td>Y</td>
      <td>17.49</td>
    </tr>
    <tr>
      <th>3</th>
      <td>MORTGAGE</td>
      <td>Individual</td>
      <td>N</td>
      <td>17.61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>OWN</td>
      <td>Individual</td>
      <td>Y</td>
      <td>17.70</td>
    </tr>
  </tbody>
</table>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Loan DTI</figcaption><p></p>
</figure>
</div>
</div>
<p>For the top three FICO scores <a href="#fig-fico">Figure&nbsp;3</a>, candidates either owned or mortgaged a home. All of the top three filed jointly. The top three lowest dti scores <a href="#fig-dti">Figure&nbsp;4</a> had applicants that rented or owned, filed either individually or jointly, and did or did not have a hardship flag. The group that owned a house, filed jointly, and enrolled in a hardship plan had the highest FICO Score and DTI.</p>
</section>
<section id="does-fico-score-change-the-interest-rate" class="level1">
<h1>Does FICO Score change the interest rate?</h1>
<p>Let’s say you have been approved for a loan. Now, the problem is the interest rate. This will effect how much your monthly payments will be. Using the accepted loan applications, I can find the interest rates people received. Since FICO scores seem to be a widely used metric, I grouped applicants by their FICO score.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fico_fair_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">580</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">669</span>)]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fico_good_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">670</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">739</span>)]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fico_very_good_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">740</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">799</span>)]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">800</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">850</span>)]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fico_fair_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>fico_good_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>fico_very_good_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>fico_fair_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Fair"</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>fico_good_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Good"</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>fico_very_good_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Very Good"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Exceptional"</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.concat([fico_fair_df, fico_good_df, fico_very_good_df, fico_exceptional_df], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>new_df[[<span class="st">'month'</span>, <span class="st">'year'</span>]] <span class="op">=</span> new_df[<span class="st">'issue_d'</span>].<span class="bu">str</span>.split(<span class="st">"-"</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>new_df[<span class="st">'issue_d'</span>] <span class="op">=</span> pd.to_datetime(new_df[<span class="st">'issue_d'</span>])</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>data_two <span class="op">=</span> new_df[new_df[<span class="st">'year'</span>] <span class="op">==</span> <span class="st">"2018"</span>]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>grouped_two <span class="op">=</span> data_two.groupby([<span class="st">'issue_d'</span>, <span class="st">'fico_category'</span>])[<span class="st">'int_rate'</span>].median()</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>(ggplot(grouped_two.reset_index(), aes(x<span class="op">=</span><span class="st">'issue_d'</span>, y<span class="op">=</span><span class="st">'int_rate'</span>, color<span class="op">=</span><span class="st">'fico_category'</span>)) <span class="op">+</span> geom_line() <span class="op">+</span> geom_point(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span> ylim(<span class="dv">0</span>,<span class="dv">25</span>) <span class="op">+</span> xlab(<span class="st">"Issue Date"</span>) <span class="op">+</span> ylab(<span class="st">"Interest Rate"</span>) <span class="op">+</span> labs(color<span class="op">=</span><span class="st">"FICO Category"</span>, title<span class="op">=</span><span class="st">"Loan Interest Rates Over Time"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="example.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">LendingClub Loan Interest Rate for 2018</figcaption><p></p>
</figure>
</div>
<p>Based on the data from 2018, it appears that a better FICO Score will result in a better interest rate. This is reinforced when looking at the interest rates from 2008 to 2018.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fico_example.gif" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Different LendingClub Loan Interest Rates by Month and Year</figcaption><p></p>
</figure>
</div>
<p>It seems like I will need to build my FICO Score to get best interest rates.</p>
</section>
<section id="is-there-a-bound-using-dti" class="level1">
<h1>Is there a bound using DTI?</h1>
<p>How does your debt status play a role? DTI or debt-to-income is designed to compare income versus debt. If you have a high ratio, it might be reasonable to assume that you are more unlikely to receive a loan. Let’s take a look:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model_df <span class="op">=</span> pd.read_csv(<span class="st">"../model_only_data.csv"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>graph_df <span class="op">=</span> model_df[[<span class="st">'debt_to_income_ratio'</span>, <span class="st">'applicant_result'</span>]][model_df[<span class="st">'debt_to_income_ratio'</span>] <span class="op">&lt;=</span> <span class="dv">100</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>counts, edges, bars <span class="op">=</span> ax.hist([graph_df[<span class="st">'debt_to_income_ratio'</span>][graph_df[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">0</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>          graph_df[<span class="st">'debt_to_income_ratio'</span>][graph_df[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">1</span>]], histtype<span class="op">=</span><span class="st">'barstacked'</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                              label<span class="op">=</span>[<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>ax.legend(prop<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">10</span>})</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Accepted and Rejected Debt-To-Income-Ratio'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>])</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">0</span>,<span class="dv">10000</span>,<span class="dv">20000</span>,<span class="dv">30000</span>,<span class="dv">40000</span>,<span class="dv">50000</span>,<span class="dv">60000</span>,<span class="dv">70000</span>])</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>ax.bar_label(bars[<span class="dv">1</span>], padding<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'black'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-hist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="blog_files/figure-html/fig-hist-output-1.png" width="592" height="431" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Loan Hist</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>For DTI ranging to about 40%, the distribution between accepted and rejected applications is fairly split <a href="#fig-hist">Figure&nbsp;5</a>. Beyond 40% DTI, the proportions of accepted applications decreases. Although, there are accepted candidates with DTI ratios spanning from 0-100%.</p>
</section>
<section id="can-the-data-effectively-predict-whether-a-candidate-will-be-accepted-or-rejected" class="level1">
<h1>Can the data effectively predict whether a candidate will be accepted or rejected?</h1>
<p>Three classification models, k-Nearest Neighbors, Decision Tree, and Logistic Regression can all predict an application’s outcome. I can combine all three models together into an ensemble model where the three models will vote on an application’s result.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Based on research, I am using the square root of the training data’s length for k.</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ModelChart.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Model Diagram</figcaption><p></p>
</figure>
</div>
<section id="fitting-models" class="level2">
<h2 class="anchored" data-anchor-id="fitting-models">Fitting Models</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>knn_new <span class="op">=</span> knn(n_neighbors<span class="op">=</span>m.ceil((<span class="bu">len</span>(pred_std_train))<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>algorithm_knn <span class="op">=</span> knn_new.fit(pred_std_train, tar_std_train)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>).fit(pred_std_train, tar_std_train)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>tree_clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>algorithm_tree <span class="op">=</span> tree_clf.fit(pred_std_train, tar_std_train)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>voting_clf_best_of_all <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>[(<span class="st">'knn'</span>, algorithm_knn), (<span class="st">'lr'</span>, clf), (<span class="st">'dt'</span>, algorithm_tree)], </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                          voting<span class="op">=</span><span class="st">'soft'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>algorithm_ens <span class="op">=</span> voting_clf_best_of_all.fit(pred_std_train, tar_std_train)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ensemble_hard <span class="op">=</span> algorithm_ens.predict(pred_std_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-equations" class="level2">
<h2 class="anchored" data-anchor-id="model-equations">Model Equations</h2>
<p>To test the model’s effectiveness, three metrics will be used. Precision, recall, and accuracy. Precision measures the accuracy of positive predictions, and recall measures the accuracy of relevant results correctly classified. Accuracy is all correctly identified over the total.</p>
<p><span class="math display">\[Precision = TP/(TP+FP)\]</span></p>
<p><span class="math display">\[Recall = TP/(TP+FN)\]</span></p>
<p><span class="math display">\[Accuracy = (TP+TN)/(TP+FP+TN+FN)\]</span></p>
</section>
<section id="confusion-matrix-and-results" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix-and-results">Confusion Matrix and Results</h2>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">'True Neg'</span>,<span class="st">'False Pos'</span>,<span class="st">'False Neg'</span>,<span class="st">'True Pos'</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>cm_ens <span class="op">=</span> confusion_matrix(tar_std_test, ensemble_hard)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">'</span><span class="sc">{0:0.0f}</span><span class="st">'</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                cm_ens.flatten()]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f'</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> v1, v2 <span class="kw">in</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(labels,group_counts)]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>disp_ens <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_ens)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale up the size of all text</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font_scale <span class="op">=</span> <span class="fl">1.1</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(cm_ens, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">''</span>, cmap<span class="op">=</span><span class="st">'Oranges'</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># set x-axis label and ticks. </span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Predicted"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_ticklabels([<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co"># set y-axis label and ticks</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Actual"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_ticklabels([<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Confusion Matrix for Loan Applications"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_model.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Ensemble Method Confusion Matrix</figcaption><p></p>
</figure>
</div>
<p><strong>Results in Percent</strong> <span class="math display">\[Precision = 91.34 \]</span> <span class="math display">\[Recall = 90.02 \]</span> <span class="math display">\[Accuracy = 90.62 \]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="importance.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Decision Tree’s Top Three Important Values</figcaption><p></p>
</figure>
</div>
<p>Overall, the results of the model were promising! Using the feature importance from the decision tree model, we can observe that employment length played a large role. Precision, recall, and accuracy all measured in the 90s. One of my fears was that ZIP Code would play a role in deciding applications. However, it appears that financial factors take more precedence.</p>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>Understanding what qualities lenders look at is important. For LendingClub, many accepted applications contain people with employment length greater than 1 year. Accepted applications also contained low DTI percentages and high FICO Scores. Building a model using matching features resulted in high metric scores and reflected an importance of financial factors. As someone that will be applying for loans, it is nice to understand what measures lenders are looking for.</p>
<section id="references" class="level2">

<!-- -->


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-chan18" class="csl-entry" role="doc-biblioentry">
Chan, Jonathan. 2018. <span>“Lending Club Data Dictionary.”</span> Kaggle. 2018. <a href="https://www.kaggle.com/datasets/jonchan2003/lending-club-data-dictionary?select=Lending+Club+Data+Dictionary+Approved.csv">https://www.kaggle.com/datasets/jonchan2003/lending-club-data-dictionary?select=Lending+Club+Data+Dictionary+Approved.csv</a>.
</div>
<div id="ref-geor19" class="csl-entry" role="doc-biblioentry">
George, Nathan. 2019. <span>“All Lending Club Loan Data.”</span> Kaggle. 2019. <a href="https://www.kaggle.com/datasets/wordsforthewise/lending-club?select=accepted_2007_to_2018Q4.csv.gz">https://www.kaggle.com/datasets/wordsforthewise/lending-club?select=accepted_2007_to_2018Q4.csv.gz</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Can You be Approved for a Loan?"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Spring 2023"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Thomas Ortega"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> false</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: simplex</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">    rendering: embed-resources</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf: default</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu"># LendingClub Loan Applications</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="al">![Photo downloaded from Unsplash: Credits - Tierra Mallorca](loanphoto.jpg)</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>LendingClub is one of many financial service companies located in the United States. Their personal loan service has received millions of applications since 2007. Out of those millions, a fraction of those applications are accepted. As a college student transitioning from a dependent to an independent in the United States, there is little doubt in my mind that I will be applying for a loan in the near future. Since I will be applying for loans, I want to understand how to maximize my odds of approval. Fortunately, some financial service companies have released information about the people that have applied for loans. Through a Kaggle dataset @geor19, I was able to track loan applicants that applied for loans through LendingClub.</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>You can find the link to my full code and documentation here: <span class="co">[</span><span class="ot">GitHub Repository</span><span class="co">](https://github.com/tortega-24/capstone-loan-applicants/tree/main)</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>The data spans 11 years, from 2007 to 2018, and contains two tables: a rejected and an accepted loan applicant table. The accepted applicant table contains approximately 2 million rows and lists over 150 features. The rejected applicant table extends out to about 27 million rows, and has exactly 9 features. To understand all of the different features, a separate Kaggle resource was used that identifies the columns that appear in the dataset @chan18. Many variables are based on financial concepts or related to the applicant following their acceptance.</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Goals and Introduction to Features</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a> My goal for the analysis was to focus on features that were easily understandable and were characteristics of the customer. I wanted to describe loan applicants and build a model using some of the features. I defined seven different questions that tackled unique aspects of the data. The table of contents describes each question I address. Here is a list of some of the features I plan to use:</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a> ZIP Code, FICO Score, Debt-to-Income Ratio, Employment Length, Reason for Loan, Homeowner Status, Hardship Status, and Interest Rate.</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a> :::{.callout-note}</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>The list of features above is not complete.</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>**Imports for Project**</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fiona</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> VotingClassifier</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier <span class="im">as</span> knn</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math <span class="im">as</span> m</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">#from plotnine import ggplot, geom_point, aes, stat_smooth, facet_wrap</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preprocessing the Data</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>Before answering the questions, the data needed to be shaped and organized. A mix of cleaning techniques were used to break the raw csv files into distinct tables: a ZIP Code table, a model table, and an accepted applicant table. The first step is to import the files as dataframes.</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>:::{.callout-important}</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>Not every piece of processing code will be displayed. Visit the repository for the complete code.</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading Data</span></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>accepted <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_2007_to_2018Q4.csv"</span>)</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>rejected <span class="op">=</span> pd.read_csv(<span class="st">"../rejected_2007_to_2018Q4.csv"</span>)</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding Result Column</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>accepted[<span class="st">'Applicant_Result'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>rejected[<span class="st">'Applicant_Result'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>The two files being imported from the Kaggle dataset are large in size and could not be uploaded to the Github repository.</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### ZIP Codes Table</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a> Next, I start processing a csv for ZIP Codes. Both raw tables contain applicants' first three digits of their ZIP Code. A new dataset will combine both ZIP Code columns and an applicant result column. A few missing values in the data will be dropped.</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>rejected[<span class="st">'Zip Code'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(rejected)</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>accepted[<span class="st">'zip_code'</span>].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(accepted)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>zip_df <span class="op">=</span> rejected[[<span class="st">'Zip Code'</span>, <span class="st">'Applicant_Result'</span>]].rename(columns<span class="op">=</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>                                                           {<span class="st">"Zip Code"</span>: <span class="st">"zip_code"</span>, <span class="st">"Applicant_Result"</span>: <span class="st">"applicant_result"</span>})</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>zip_df <span class="op">=</span> pd.concat([zip_df, accepted[[<span class="st">'zip_code'</span>, <span class="st">'Applicant_Result'</span>]].rename(columns<span class="op">=</span>{<span class="st">"Applicant_Result"</span>: <span class="st">"applicant_result"</span>})]</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>                   , axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>zip_df.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>zip_df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>zip_df.head()</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accepted Loans Table</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>The next table I will be making lists accepted loan applications. To clean the columns I defined how many missing values were in each feature. Then, I decided to remove columns that contained at least 30% missing values.</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>col_to_be_dropped <span class="op">=</span> []</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> accepted.columns:</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (accepted[column].isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(accepted)) <span class="op">&gt;</span> <span class="fl">0.3</span>:</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>        col_to_be_dropped.append(column)</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>trimmed_accepted <span class="op">=</span> accepted.drop(col_to_be_dropped, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>trimmed_accepted.shape</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>After looking over the columns, I selected variables that would be most related to the questions I planned to answer. Then, after selecting my features, I took the percentage of values I would have left if I decided to drop their NA rows. With a remaining 91%, I decided it would be acceptable to drop the missing values instead of attempting to replace them. Lastly, I changed the type of the FICO Score columns and the policy code to integers. The final table consisted of 17 features.</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>columns_needed <span class="op">=</span> [<span class="st">'loan_amnt'</span>, <span class="st">'title'</span>, <span class="st">'last_fico_range_low'</span>, <span class="st">'last_fico_range_high'</span>,</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'dti'</span>, <span class="st">'zip_code'</span>, <span class="st">'addr_state'</span>, <span class="st">'emp_length'</span>, <span class="st">'emp_title'</span>, </span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'funded_amnt'</span>, <span class="st">'hardship_flag'</span>, <span class="st">'home_ownership'</span>, <span class="st">'loan_status'</span>, </span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'application_type'</span>, <span class="st">'issue_d'</span>, <span class="st">'policy_code'</span>, <span class="st">'Applicant_Result'</span>]</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="co"># accepted_project_cut = accepted_project.dropna(axis=0)</span></span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="co"># len(accepted_project_cut)/len(accepted_project) = 0.9168417229876927</span></span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>accepted_project <span class="op">=</span> trimmed_accepted[columns_needed]</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>accepted_project.dropna(axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'last_fico_range_low'</span>] <span class="op">=</span> accepted_project[<span class="st">'last_fico_range_low'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'last_fico_range_high'</span>] <span class="op">=</span> accepted_project[<span class="st">'last_fico_range_high'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>accepted_project[<span class="st">'policy_code'</span>] <span class="op">=</span> accepted_project[<span class="st">'policy_code'</span>].astype(<span class="st">'int64'</span>)</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>accepted_project.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accepted and Rejected Loans Table</span></span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>Lastly, I wanted to build a table that combined both accepted and rejected loan applications. To start, all columns from the rejected table were attempted to be matched to a column from the accepted table. The 'Risk_Score' column in the rejected applicant table was not considered because it contained too many missing values (~18 million). The remaining columns had a low percentage of missing values and those observations were dropped. Another edit that was made changed the debt-to-income ratio column to be a float type. To do this, I removed the percent sign and converted the data type. </span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>trimmed_rejected <span class="op">=</span> rejected.drop([<span class="st">'Risk_Score'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>] <span class="op">=</span> trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>].<span class="bu">str</span>.replace(<span class="st">'%'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>] <span class="op">=</span> trimmed_rejected[<span class="st">'Debt-To-Income Ratio'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>Next, I used the sample method to take 100,000 rows from each table and concatenated them to form a new table. Finally, all three tables were written as csv files.</span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="fu"># Is employment length significant?</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>To analyze the employment length, a grouped bar chart comparing loan applicants was made. This was taken using the model data that randomly sampled both loan applications.</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-employment</span></span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Employment Length"</span></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../model_only_data.csv"</span>)</span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>question_one <span class="op">=</span> df[[<span class="st">'applicant_result'</span>, <span class="st">'emp_length'</span>]]</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(pd.unique(question_one[<span class="st">'emp_length'</span>])))</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> question_one[<span class="st">'emp_length'</span>][question_one[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">1</span>].value_counts().sort_index().values</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> question_one[<span class="st">'emp_length'</span>][question_one[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">0</span>].value_counts().sort_index().values</span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> y1[<span class="dv">0</span>]</span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">0</span>] <span class="op">=</span> y1[<span class="dv">10</span>]</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>temp2 <span class="op">=</span> y1[<span class="dv">1</span>]</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">1</span>] <span class="op">=</span> temp</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>y1[<span class="dv">10</span>] <span class="op">=</span> temp2</span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> y2[<span class="dv">0</span>]</span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">0</span>] <span class="op">=</span> y2[<span class="dv">10</span>]</span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>temp2 <span class="op">=</span> y2[<span class="dv">1</span>]</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">1</span>] <span class="op">=</span> temp</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>y2[<span class="dv">10</span>] <span class="op">=</span> temp2</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>plt.bar(x<span class="op">-</span><span class="fl">0.2</span>, y1, width, color<span class="op">=</span><span class="st">'cyan'</span>)</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>plt.bar(x, y2, width, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>plt.xticks(x, [<span class="st">'&lt; 1 year'</span>, <span class="st">'1 year'</span>, <span class="st">'2 years'</span>, <span class="st">'3 years'</span>, <span class="st">'4 years'</span>, <span class="st">'5 years'</span>, <span class="st">'6 years'</span>, <span class="st">'7 years'</span>, <span class="st">'8 years'</span></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'9 years'</span>, <span class="st">'10+ years'</span>], rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Self-Reported Employment Length"</span>)</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Counts"</span>)</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Accepted Vs. Rejected Based on Employment Length"</span>)</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">"Accepted"</span>, <span class="st">"Rejected"</span>])</span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>In @fig-employment many of the rejected candidates reported that they have been at their job for less than a year. In contrast, a large portion of accepted applications listed an employment length of 10 plus years. Based on the visual, it appears that applicants with a year or more experience are favored.</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="fu"># Are specific loans given during certain months?</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>Utilizing natural language processing and some manual identification, I was able to group many of the different reasons applicants applied for loans. This was reflected in a rose chart that is labeled by month and takes all accepted applicant data from 2007-2018.</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Natural Language Processing</span></span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: True</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>corpus <span class="op">=</span> <span class="st">""</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> i <span class="op">&lt;</span> <span class="bu">len</span>(df[<span class="st">'reason_for_loan'</span>]):</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>    corpus <span class="op">+=</span> <span class="st">" "</span> <span class="op">+</span> df[<span class="st">'reason_for_loan'</span>][i]</span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">"english"</span>)) <span class="co"># creating a list of stop words in the english language</span></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>filtered_list <span class="op">=</span> []</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> words: <span class="co"># For every word</span></span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> word.casefold() <span class="kw">not</span> <span class="kw">in</span> stop_words: <span class="co"># Is the lowercase word in the stop words list?</span></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>        filtered_list.append(word)</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>lemma_corpus <span class="op">=</span> []</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>no_match <span class="op">=</span> []</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> word, tag <span class="kw">in</span> nltk.pos_tag(filtered_list):</span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>    wntag <span class="op">=</span> tag[<span class="dv">0</span>].lower()</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>    wntag <span class="op">=</span> wntag <span class="cf">if</span> wntag <span class="kw">in</span> [<span class="st">'a'</span>, <span class="st">'r'</span>, <span class="st">'n'</span>, <span class="st">'v'</span>] <span class="cf">else</span> <span class="va">None</span></span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> wntag:</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>        lemma <span class="op">=</span> word <span class="co"># if it is not one of the above word types</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>        no_match.append(lemma)</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>        lemma <span class="op">=</span> lemmatizer.lemmatize(word, wntag) <span class="co"># using the tag to properly reduce the word</span></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>        lemma_corpus.append(lemma)</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>no_match_series <span class="op">=</span> pd.Series(no_match)</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series <span class="op">=</span> pd.Series(lemma_corpus)</span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at the top words</span></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series.value_counts().index[<span class="dv">0</span>:<span class="dv">100</span>]</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>lemma_corpus_series.value_counts().index[<span class="dv">100</span>:<span class="dv">150</span>]</span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>no_match_series.value_counts().index[<span class="dv">0</span>:<span class="dv">50</span>]</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Categories that the information was sorted into</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>home <span class="op">=</span> [<span class="st">'home'</span>, <span class="st">'house'</span>, <span class="st">'kitchen'</span>, <span class="st">'improvement'</span>, <span class="st">'pool'</span>, <span class="st">'remodel'</span>]</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>car <span class="op">=</span> [<span class="st">'car'</span>, <span class="st">'auto'</span>, <span class="st">'motorcycle'</span>, <span class="st">'vehicle'</span>, <span class="st">'truck'</span>]</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>business <span class="op">=</span> [<span class="st">'business'</span>]</span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>medical <span class="op">=</span> [<span class="st">'medical'</span>, <span class="st">'remove'</span>]</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>debt_credit_issues <span class="op">=</span> [<span class="st">'consolidation'</span>, <span class="st">'credit'</span>, <span class="st">'debt'</span>, <span class="st">'refinancing'</span>, <span class="st">'card'</span>, <span class="st">'cc'</span>, <span class="st">'consolidate'</span>, <span class="st">'payoff'</span>, </span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'interest'</span>, <span class="st">'rate'</span>] </span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>moving <span class="op">=</span> [<span class="st">'move'</span>, <span class="st">'moving'</span>]</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>major_purchase <span class="op">=</span> [<span class="st">'purchase'</span>, <span class="st">'major'</span>]</span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>vacation <span class="op">=</span> [<span class="st">'vacation'</span>]</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>wedding <span class="op">=</span> [<span class="st">'wedding'</span>, <span class="st">'ring'</span>]</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>student <span class="op">=</span> [<span class="st">'student'</span>, <span class="st">'college'</span>, <span class="st">'education'</span>, <span class="st">'school'</span>]</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Code used to check the context of specific words</span></span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a><span class="co">#l = []</span></span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a><span class="co">#for thing in df['reason_for_loan']:</span></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a><span class="co">#    if thing.find("refinancing") != -1:</span></span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a><span class="co">#        l.append(thing)</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a><span class="co">#print(pd.unique(l))</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graphic</span></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-type</span></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Loan Type"</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>group_dates <span class="op">=</span> pd.read_csv(<span class="st">"../group_dates.csv"</span>)</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar_polar(group_dates, r<span class="op">=</span><span class="st">"count"</span>,theta<span class="op">=</span><span class="st">'issue_month'</span>,</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span><span class="st">"reduced_reason"</span>, labels<span class="op">=</span>{<span class="st">"reduced_reason"</span>: <span class="st">"Loan Types"</span>})</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>fig.update_layout(legend<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>    yanchor<span class="op">=</span><span class="st">"top"</span>,</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="fl">0.80</span>,</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>    xanchor<span class="op">=</span><span class="st">"left"</span>,</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="fl">1.1</span>,</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>    bgcolor<span class="op">=</span><span class="st">"LightGray"</span>,</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>    bordercolor<span class="op">=</span><span class="st">"Black"</span>,</span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>    borderwidth<span class="op">=</span><span class="dv">1</span>),font<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="dv">15</span>))</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_nticks<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>fig.update_polars(angularaxis_tickfont_size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_tickfont_size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_angle<span class="op">=</span><span class="dv">70</span>)</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a>fig.update_polars(radialaxis_tickangle<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>  <span class="st">'toImageButtonOptions'</span>: {</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">'format'</span>: <span class="st">'png'</span>, <span class="co"># one of png, svg, jpeg, webp</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>    <span class="st">'filename'</span>: <span class="st">'custom_image'</span>,</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>    <span class="st">'height'</span>: <span class="dv">1680</span>,</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>    <span class="st">'width'</span>: <span class="dv">2380</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>fig.show(config<span class="op">=</span>config)</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>Looking at the rose chart @fig-type, we can observe a couple things. Firstly, three of the 12 months have a noticeable drop in overall accepted applicant counts. Why is there a drop? It is not entirely clear. Nothing jumps out as an explanation while doing some Googling. It might be a situation unique to LendingClub. </span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>I can shed some light on whether the pattern is consistent for each year or different. By creating a gif, we can observe the yearly changes in counts by month.</span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a><span class="al">![Different LendingClub Loan Applications by Month and Year](loantypes.gif)</span></span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>Note that the gif ranges from 2008 to 2018. It does not cover 2007 because LendingClub had small counts for that year and did not accept candidates in every month.</span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a><span class="fu"># What is the rate of acceptance?</span></span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>LendingClub has had over <span class="co">[</span><span class="ot">4 million members</span><span class="co">](https://ir.lendingclub.com/news/news-details/2022/LendingClub-Surpasses-4-Million-Members/default.aspx)</span> with people signing up across the United States. So, what does the acceptance rate look like across the U.S.? Using census data, I made a choropleth graphic visualizing the acceptance rate across 48 of the states–sorry Alaska and Hawaii. </span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>Alaskan and Hawaiian citizens can apply for loans via LendingClub; but, they are not included because it stretches the choropleth.</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>df_map_2015 <span class="op">=</span> gpd.read_file(<span class="st">'../2015_map_data.shp'</span>)</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>matplotlib.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">50</span>))</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>df_map_2015.plot(column <span class="op">=</span> df_map_2015[<span class="st">'accepted_rejected_ratio'</span>], cmap<span class="op">=</span><span class="st">'viridis'</span>, legend<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>            legend_kwds<span class="op">=</span>{<span class="st">'label'</span>: <span class="st">"Ratio of Accepted Applicants"</span>, <span class="st">'orientation'</span>: <span class="st">"horizontal"</span>, <span class="st">"pad"</span>: <span class="fl">0.01</span>,</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"shrink"</span>: <span class="fl">.7</span>}, ax<span class="op">=</span>ax, alpha<span class="op">=</span><span class="fl">.9</span>)</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="op">-</span><span class="dv">126</span>, <span class="op">-</span><span class="dv">65</span>)</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">24</span>, <span class="dv">50</span>)</span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>plt.title</span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a><span class="al">![Ratio of Accepted Applicants by ZIP Code](ratio_accepted.png)</span></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a>The interesting thing that stands out is the large, scary space outlining the state of Iowa. As of the dates collected from the Kaggle dataset, Iowa did not allow their citizens to apply for loans with LendingClub. This is the most likely explanation for the abysmal acceptance rate. Besides Iowa's low rate, no other group of ZIP Codes stand out.</span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a><span class="fu"># How does debt-to-income and FICO Score change based on hardship flag, home ownership, and application type?</span></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a>Loan applicants that are approved for loans must have differences between each other–right? To take a further look, I describe applicants by their homeowner status, whether they filed jointly or not, and if they have had to reduce their payment plans in the past (hardhip flag). Those features will be ordered based on median FICO scores and debt-to-income (DTI) ratios.</span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fico</span></span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Loan FICO"</span></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'home_ownership'</span>].isin([<span class="st">'OTHER'</span>, <span class="st">'ANY'</span>, <span class="st">'NONE'</span>])]</span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a>grouped_values <span class="op">=</span> df_new.groupby([<span class="st">'home_ownership'</span>, <span class="st">'application_type'</span>, <span class="st">'hardship_flag'</span>])[<span class="st">'fico_range_low'</span>].median()</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>grouped_values <span class="op">=</span> pd.DataFrame(grouped_values)</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a>grouped_values.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> grouped_values.sort_values(by<span class="op">=</span><span class="st">'fico_range_low'</span>,ascending<span class="op">=</span><span class="va">False</span>).head()</span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a>sorted_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>,drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a>sorted_df.rename(columns<span class="op">=</span>{<span class="st">"home_ownership"</span>: <span class="st">"Ownership"</span>, <span class="st">"application_type"</span>: <span class="st">"Application Type"</span>, </span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"hardship_flag"</span>: <span class="st">"Hardship Flag"</span>, <span class="st">"fico_range_low"</span>: <span class="st">"FICO Score"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>sorted_df</span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dti</span></span>
<span id="cb17-405"><a href="#cb17-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Loan DTI"</span></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a>df_new <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'home_ownership'</span>].isin([<span class="st">'OTHER'</span>, <span class="st">'ANY'</span>, <span class="st">'NONE'</span>])]</span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>grouped_values_dti <span class="op">=</span> df_new.groupby([<span class="st">'home_ownership'</span>, <span class="st">'application_type'</span>, <span class="st">'hardship_flag'</span>])[<span class="st">'dti'</span>].median()</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>grouped_values_dti <span class="op">=</span> pd.DataFrame(grouped_values_dti)</span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>grouped_values_dti.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="op">=</span> grouped_values_dti.sort_values(by<span class="op">=</span><span class="st">'dti'</span>, ascending<span class="op">=</span><span class="va">True</span>).head()</span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a>sorted_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>,drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>sorted_df.rename(columns<span class="op">=</span>{<span class="st">"home_ownership"</span>: <span class="st">"Ownership"</span>, <span class="st">"application_type"</span>: <span class="st">"Application Type"</span>, </span>
<span id="cb17-415"><a href="#cb17-415" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"hardship_flag"</span>: <span class="st">"Hardship Flag"</span>, <span class="st">"dti"</span>: <span class="st">"Debt-to-Income Ratio"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a>sorted_df</span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>For the top three FICO scores @fig-fico, candidates either owned or mortgaged a home. All of the top three filed jointly. The top three lowest dti scores @fig-dti had applicants that rented or owned, filed either individually or jointly, and did or did not have a hardship flag. The group that owned a house, filed jointly, and enrolled in a hardship plan had the highest FICO Score and DTI.</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a><span class="fu"># Does FICO Score change the interest rate?</span></span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>Let's say you have been approved for a loan. Now, the problem is the interest rate. This will effect how much your monthly payments will be. Using the accepted loan applications, I can find the interest rates people received. Since FICO scores seem to be a widely used metric, I grouped applicants by their FICO score.</span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../accepted_only_data.csv"</span>)</span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a>fico_fair_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">580</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">669</span>)]</span>
<span id="cb17-432"><a href="#cb17-432" aria-hidden="true" tabindex="-1"></a>fico_good_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">670</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">739</span>)]</span>
<span id="cb17-433"><a href="#cb17-433" aria-hidden="true" tabindex="-1"></a>fico_very_good_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">740</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">799</span>)]</span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df <span class="op">=</span> df[(df[<span class="st">'fico_range_low'</span>] <span class="op">&gt;=</span> <span class="dv">800</span>) <span class="op">&amp;</span> (df[<span class="st">'fico_range_low'</span>] <span class="op">&lt;=</span> <span class="dv">850</span>)]</span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a>fico_fair_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a>fico_good_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a>fico_very_good_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a>fico_fair_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Fair"</span></span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a>fico_good_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Good"</span></span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a>fico_very_good_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Very Good"</span></span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a>fico_exceptional_df[<span class="st">'fico_category'</span>] <span class="op">=</span> <span class="st">"Exceptional"</span></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.concat([fico_fair_df, fico_good_df, fico_very_good_df, fico_exceptional_df], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a>new_df[[<span class="st">'month'</span>, <span class="st">'year'</span>]] <span class="op">=</span> new_df[<span class="st">'issue_d'</span>].<span class="bu">str</span>.split(<span class="st">"-"</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a>new_df[<span class="st">'issue_d'</span>] <span class="op">=</span> pd.to_datetime(new_df[<span class="st">'issue_d'</span>])</span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>data_two <span class="op">=</span> new_df[new_df[<span class="st">'year'</span>] <span class="op">==</span> <span class="st">"2018"</span>]</span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>grouped_two <span class="op">=</span> data_two.groupby([<span class="st">'issue_d'</span>, <span class="st">'fico_category'</span>])[<span class="st">'int_rate'</span>].median()</span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>(ggplot(grouped_two.reset_index(), aes(x<span class="op">=</span><span class="st">'issue_d'</span>, y<span class="op">=</span><span class="st">'int_rate'</span>, color<span class="op">=</span><span class="st">'fico_category'</span>)) <span class="op">+</span> geom_line() <span class="op">+</span> geom_point(color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="dv">3</span>) <span class="op">+</span> ylim(<span class="dv">0</span>,<span class="dv">25</span>) <span class="op">+</span> xlab(<span class="st">"Issue Date"</span>) <span class="op">+</span> ylab(<span class="st">"Interest Rate"</span>) <span class="op">+</span> labs(color<span class="op">=</span><span class="st">"FICO Category"</span>, title<span class="op">=</span><span class="st">"Loan Interest Rates Over Time"</span>))</span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a><span class="al">![LendingClub Loan Interest Rate for 2018](example.png)</span></span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>Based on the data from 2018, it appears that a better FICO Score will result in a better interest rate. This is reinforced when looking at the interest rates from 2008 to 2018.</span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="al">![Different LendingClub Loan Interest Rates by Month and Year](fico_example.gif)</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>It seems like I will need to build my FICO Score to get best interest rates.</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a><span class="fu"># Is there a bound using DTI?</span></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a>How does your debt status play a role? DTI or debt-to-income is designed to compare income versus debt. If you have a high ratio, it might be reasonable to assume that you are more unlikely to receive a loan. Let's take a look:</span>
<span id="cb17-465"><a href="#cb17-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hist</span></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Loan Hist"</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>model_df <span class="op">=</span> pd.read_csv(<span class="st">"../model_only_data.csv"</span>)</span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a>graph_df <span class="op">=</span> model_df[[<span class="st">'debt_to_income_ratio'</span>, <span class="st">'applicant_result'</span>]][model_df[<span class="st">'debt_to_income_ratio'</span>] <span class="op">&lt;=</span> <span class="dv">100</span>]</span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a>counts, edges, bars <span class="op">=</span> ax.hist([graph_df[<span class="st">'debt_to_income_ratio'</span>][graph_df[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">0</span>],</span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a>          graph_df[<span class="st">'debt_to_income_ratio'</span>][graph_df[<span class="st">'applicant_result'</span>] <span class="op">==</span> <span class="dv">1</span>]], histtype<span class="op">=</span><span class="st">'barstacked'</span>, </span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a>                              label<span class="op">=</span>[<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>ax.legend(prop<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">10</span>})</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Accepted and Rejected Debt-To-Income-Ratio'</span>)</span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>])</span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">0</span>,<span class="dv">10000</span>,<span class="dv">20000</span>,<span class="dv">30000</span>,<span class="dv">40000</span>,<span class="dv">50000</span>,<span class="dv">60000</span>,<span class="dv">70000</span>])</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a>ax.bar_label(bars[<span class="dv">1</span>], padding<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'black'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a>For DTI ranging to about 40%, the distribution between accepted and rejected applications is fairly split @fig-hist. Beyond 40% DTI, the proportions of accepted applications decreases. Although, there are accepted candidates with DTI ratios spanning from 0-100%.</span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a><span class="fu"># Can the data effectively predict whether a candidate will be accepted or rejected?</span></span>
<span id="cb17-489"><a href="#cb17-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-490"><a href="#cb17-490" aria-hidden="true" tabindex="-1"></a>Three classification models, k-Nearest Neighbors, Decision Tree, and Logistic Regression can all predict an application's outcome. I can combine all three models together into an ensemble model where the three models will vote on an application's result.</span>
<span id="cb17-491"><a href="#cb17-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-492"><a href="#cb17-492" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb17-493"><a href="#cb17-493" aria-hidden="true" tabindex="-1"></a>Based on research, I am using the square root of the training data's length for k.</span>
<span id="cb17-494"><a href="#cb17-494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-495"><a href="#cb17-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-496"><a href="#cb17-496" aria-hidden="true" tabindex="-1"></a><span class="al">![Model Diagram](ModelChart.png)</span></span>
<span id="cb17-497"><a href="#cb17-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-498"><a href="#cb17-498" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting Models</span></span>
<span id="cb17-499"><a href="#cb17-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-502"><a href="#cb17-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-503"><a href="#cb17-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-504"><a href="#cb17-504" aria-hidden="true" tabindex="-1"></a>knn_new <span class="op">=</span> knn(n_neighbors<span class="op">=</span>m.ceil((<span class="bu">len</span>(pred_std_train))<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))</span>
<span id="cb17-505"><a href="#cb17-505" aria-hidden="true" tabindex="-1"></a>algorithm_knn <span class="op">=</span> knn_new.fit(pred_std_train, tar_std_train)</span>
<span id="cb17-506"><a href="#cb17-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-507"><a href="#cb17-507" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>).fit(pred_std_train, tar_std_train)</span>
<span id="cb17-508"><a href="#cb17-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-509"><a href="#cb17-509" aria-hidden="true" tabindex="-1"></a>tree_clf <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb17-510"><a href="#cb17-510" aria-hidden="true" tabindex="-1"></a>algorithm_tree <span class="op">=</span> tree_clf.fit(pred_std_train, tar_std_train)</span>
<span id="cb17-511"><a href="#cb17-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-512"><a href="#cb17-512" aria-hidden="true" tabindex="-1"></a>voting_clf_best_of_all <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>[(<span class="st">'knn'</span>, algorithm_knn), (<span class="st">'lr'</span>, clf), (<span class="st">'dt'</span>, algorithm_tree)], </span>
<span id="cb17-513"><a href="#cb17-513" aria-hidden="true" tabindex="-1"></a>                                          voting<span class="op">=</span><span class="st">'soft'</span>)</span>
<span id="cb17-514"><a href="#cb17-514" aria-hidden="true" tabindex="-1"></a>algorithm_ens <span class="op">=</span> voting_clf_best_of_all.fit(pred_std_train, tar_std_train)</span>
<span id="cb17-515"><a href="#cb17-515" aria-hidden="true" tabindex="-1"></a>ensemble_hard <span class="op">=</span> algorithm_ens.predict(pred_std_test)</span>
<span id="cb17-516"><a href="#cb17-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-517"><a href="#cb17-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-518"><a href="#cb17-518" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Equations</span></span>
<span id="cb17-519"><a href="#cb17-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-520"><a href="#cb17-520" aria-hidden="true" tabindex="-1"></a>To test the model's effectiveness, three metrics will be used. Precision, recall, and accuracy. Precision measures the accuracy of positive predictions, and recall measures the accuracy of relevant results correctly classified. Accuracy is all correctly identified over the total.</span>
<span id="cb17-521"><a href="#cb17-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-522"><a href="#cb17-522" aria-hidden="true" tabindex="-1"></a>$$Precision = TP/(TP+FP)$$</span>
<span id="cb17-523"><a href="#cb17-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-524"><a href="#cb17-524" aria-hidden="true" tabindex="-1"></a>$$Recall = TP/(TP+FN)$$</span>
<span id="cb17-525"><a href="#cb17-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-526"><a href="#cb17-526" aria-hidden="true" tabindex="-1"></a>$$Accuracy = (TP+TN)/(TP+FP+TN+FN)$$</span>
<span id="cb17-527"><a href="#cb17-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-528"><a href="#cb17-528" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confusion Matrix and Results</span></span>
<span id="cb17-529"><a href="#cb17-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-532"><a href="#cb17-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-533"><a href="#cb17-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb17-534"><a href="#cb17-534" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">'True Neg'</span>,<span class="st">'False Pos'</span>,<span class="st">'False Neg'</span>,<span class="st">'True Pos'</span>]</span>
<span id="cb17-535"><a href="#cb17-535" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>]</span>
<span id="cb17-536"><a href="#cb17-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-537"><a href="#cb17-537" aria-hidden="true" tabindex="-1"></a>cm_ens <span class="op">=</span> confusion_matrix(tar_std_test, ensemble_hard)</span>
<span id="cb17-538"><a href="#cb17-538" aria-hidden="true" tabindex="-1"></a>group_counts <span class="op">=</span> [<span class="st">'</span><span class="sc">{0:0.0f}</span><span class="st">'</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span></span>
<span id="cb17-539"><a href="#cb17-539" aria-hidden="true" tabindex="-1"></a>                cm_ens.flatten()]</span>
<span id="cb17-540"><a href="#cb17-540" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="ss">f'</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> v1, v2 <span class="kw">in</span></span>
<span id="cb17-541"><a href="#cb17-541" aria-hidden="true" tabindex="-1"></a>          <span class="bu">zip</span>(labels,group_counts)]</span>
<span id="cb17-542"><a href="#cb17-542" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> np.asarray(labels).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb17-543"><a href="#cb17-543" aria-hidden="true" tabindex="-1"></a>disp_ens <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>cm_ens)</span>
<span id="cb17-544"><a href="#cb17-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-545"><a href="#cb17-545" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb17-546"><a href="#cb17-546" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale up the size of all text</span></span>
<span id="cb17-547"><a href="#cb17-547" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(font_scale <span class="op">=</span> <span class="fl">1.1</span>)</span>
<span id="cb17-548"><a href="#cb17-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-549"><a href="#cb17-549" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(cm_ens, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">''</span>, cmap<span class="op">=</span><span class="st">'Oranges'</span>)</span>
<span id="cb17-550"><a href="#cb17-550" aria-hidden="true" tabindex="-1"></a><span class="co"># set x-axis label and ticks. </span></span>
<span id="cb17-551"><a href="#cb17-551" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Predicted"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-552"><a href="#cb17-552" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_ticklabels([<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb17-553"><a href="#cb17-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-554"><a href="#cb17-554" aria-hidden="true" tabindex="-1"></a><span class="co"># set y-axis label and ticks</span></span>
<span id="cb17-555"><a href="#cb17-555" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Actual"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, labelpad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-556"><a href="#cb17-556" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_ticklabels([<span class="st">'Rejected'</span>, <span class="st">'Accepted'</span>])</span>
<span id="cb17-557"><a href="#cb17-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-558"><a href="#cb17-558" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Confusion Matrix for Loan Applications"</span>, fontsize<span class="op">=</span><span class="dv">20</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-559"><a href="#cb17-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-560"><a href="#cb17-560" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-561"><a href="#cb17-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-562"><a href="#cb17-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-563"><a href="#cb17-563" aria-hidden="true" tabindex="-1"></a><span class="al">![Ensemble Method Confusion Matrix](results_model.png)</span></span>
<span id="cb17-564"><a href="#cb17-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-565"><a href="#cb17-565" aria-hidden="true" tabindex="-1"></a>**Results in Percent**</span>
<span id="cb17-566"><a href="#cb17-566" aria-hidden="true" tabindex="-1"></a>$$Precision = 91.34 $$</span>
<span id="cb17-567"><a href="#cb17-567" aria-hidden="true" tabindex="-1"></a>$$Recall = 90.02 $$</span>
<span id="cb17-568"><a href="#cb17-568" aria-hidden="true" tabindex="-1"></a>$$Accuracy = 90.62 $$</span>
<span id="cb17-569"><a href="#cb17-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-570"><a href="#cb17-570" aria-hidden="true" tabindex="-1"></a><span class="al">![Decision Tree's Top Three Important Values](importance.png)</span></span>
<span id="cb17-571"><a href="#cb17-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-572"><a href="#cb17-572" aria-hidden="true" tabindex="-1"></a>Overall, the results of the model were promising! Using the feature importance from the decision tree model, we can observe that employment length played a large role. Precision, recall, and accuracy all measured in the 90s. One of my fears was that ZIP Code would play a role in deciding applications. However, it appears that financial factors take more precedence.</span>
<span id="cb17-573"><a href="#cb17-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-574"><a href="#cb17-574" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusions</span></span>
<span id="cb17-575"><a href="#cb17-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-576"><a href="#cb17-576" aria-hidden="true" tabindex="-1"></a>Understanding what qualities lenders look at is important. For LendingClub, many accepted applications contain people with employment length greater than 1 year. Accepted applications also contained low DTI percentages and high FICO Scores. Building a model using matching features resulted in high metric scores and reflected an importance of financial factors. As someone that will be applying for loans, it is nice to understand what measures lenders are looking for.</span>
<span id="cb17-577"><a href="#cb17-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-578"><a href="#cb17-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>